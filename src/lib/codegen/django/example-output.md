# Django Migration Generator - Example Output

## Input: Simple Table with Foreign Key

Table: `companies`
- id (INT, PRIMARY KEY, AUTO_INCREMENT)
- user_id (INT, UNIQUE, FOREIGN KEY to users.id)
- balance (DECIMAL(10,2))

## Generated Django Migration (MySQL)

```python
# Generated by Database Designer
# Migration for MySQL schema

from django.db import migrations


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.RunSQL(
            "CREATE TABLE `companies` ( `id` INT PRIMARY KEY NOT NULL AUTO_INCREMENT, `user_id` INT UNIQUE, `balance` DECIMAL(10,2) )",
            reverse_sql="DROP TABLE `companies`"
        ),
    ]
```

## Generated Django Migration (PostgreSQL)

```python
# Generated by Database Designer
# Migration for PostgreSQL schema

from django.db import migrations


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.RunSQL(
            "CREATE TYPE companies_status_enum AS ENUM ('ACTIVE', 'INACTIVE')",
            reverse_sql="DROP TYPE IF EXISTS companies_status_enum;"
        ),
        migrations.RunSQL(
            "CREATE TABLE \"companies\" ( \"id\" BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, \"user_id\" INT UNIQUE, \"balance\" DECIMAL(10,2), \"status\" companies_status_enum )",
            reverse_sql="DROP TABLE \"companies\""
        ),
        migrations.RunSQL(
            "CREATE UNIQUE INDEX \"companies_user_idx\" ON \"companies\" (\"user_id\")",
            reverse_sql="DROP INDEX IF EXISTS \"companies_user_idx\";"
        ),
    ]
```

## Foreign Key Constraints Migration

```python
# Generated by Database Designer
# Foreign Key Constraints Migration

from django.db import migrations


class Migration(migrations.Migration):

    dependencies = [
        # Add your app dependencies here
    ]

    operations = [
        migrations.RunSQL(
            "ALTER TABLE `companies` ADD CONSTRAINT `fk_companies_user_id` FOREIGN KEY (`user_id`) REFERENCES `users`(`id`)",
            reverse_sql="ALTER TABLE `companies` DROP FOREIGN KEY `fk_companies_user_id`"
        ),
    ]
```

## Key Features

1. **SQL-Based Migrations**: Uses raw SQL for precise database schema control
2. **Database Compatibility**: Supports both MySQL and PostgreSQL with proper syntax
3. **Table Ordering**: Tables are created in dependency order
4. **Reversible Operations**: All migrations include proper reverse SQL
5. **Complete Schema**: Includes indexes, constraints, and custom types
6. **Separate Files**: Each table gets its own migration file for better organization

## File Structure

```
migrations/
├── 20250109120200_create_users_table.py
├── 20250109120201_create_companies_table.py
├── 20250109120202_create_permissions_table.py
└── 20250109120203_add_foreign_key_constraints.py
```

## Installation in Django Project

1. Copy the generated migration files to your Django app's migrations/ directory
2. Run `python manage.py migrate` to execute the migrations
3. The migrations will create the exact database schema from your diagram